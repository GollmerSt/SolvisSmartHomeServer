Ä N D E R U N G EN

Version 00.10.07

	11.02.2020	Die berecnneten Werte (Xx...) wurden erst dann zum Client geschickt, wenn sie sich nach dem Neustart
				des Servers einmal verändert hatten.
				
				Kanal S11 korrigiert. Name und Einheit geändert
				
				
	14.02.2020	Synchronisations-Problem zwischen stündlichem und sofortigem Update der Fhem-Daten gefixt.
				Führte sporadisch zu Null-Pointer-Exceptions.
				
				Server-Befehle GUI_COMMANDS_ENABLE/GUI_COMMANDS_DISABLE eingeführt, um sicher zu stellen, dass
				im Wartungsfall der Anlage der Server nicht für den Service-Mitarbeiter Unerklärbares ausführt.
				
	17.02.2020	Das Web-GUI der SolvisControl ist abhängig von der TouchScreen-Kalibrierung! Das kann sich in
				leichten Versatz, im ungünstigsten Fall durch Artefakte am Rande äußern. Da sowohl die Verschiebung
				als auch die Artefakte die Erkennung stören kann, wird nun in der Learningphase dieser Versatz
				aus dem Home-Screen ermittelt und entsprechend korrigiert. Dazu wird das rechte Aufeinandertreffen
				der Linien zwischen den Wasser- und Solarbuttons des Home-Screen hergenommen.
				
	18.02.2020	Neues Features:
				Service-User-Zugriffe werden nun über die Bildschirme "Schornsteinfeger", "Nutzerauswahl",
				"Nutzerauswahl Codeeingabe" erkannt. Die GUI-Befehle sind unterdrückt, solange die SolvisControl
				diese Bildschirme anzeigt. Außerdem hat das zur Folge, dass nun jeder weitere erkannte Nutzer-
				Eingriff eine Sperrung der GUI-Befehle für eine Stunde bewirkt (sonst 5 Minuten). Erst wenn diese
				Stunde überschritten ist, ist der Server im normalen Mode. Will man letztere Zeit verringern,
				kann man den Server über den Fhem-Client mit dem Server-Command "SERVICE_RESET" wieder in den
				normalen Zustand bringen.
				
				Der User kann nun über die base.xml bestimmen, welche GUI-Feature des Servers aktiviert sein sollen.
				Die base.xml wurde dazu um ein "Feature"-Element erweitert. Die im Paket mitgelieferte base.xml hat
				sämtliche GUI Features deaktiviert! Auf diese Weise greift der Server erstmal nicht aktiv in die Bedienung
				ein. Der User bestimmt, was er freischalten will.
				
				Fhem-Client um das Attribut "GuiCommandsEnabled" ergänzt. Ist dieses Attribut auf FALSE, werden sämtliche
				Kommandos verhindert, welche das GUI der SolvisControl benötigen. Nur Messwerte werden aufgezeichnet.
				TRUE lassen die Kommandos wieder zu. Der Hintergrund ist der, dass Service-Mitarbeiter nicht durch diese
				Automatiken irritiert werden und einen Defekt der Anlage vermuten. SET/GET-Kommandos, welche in dieser Zeit
				erfolgen, werden zwischengepuffert und ausgeführt, wenn das Attribut wieder auf TRUE gesetzt wurde.
	


Version 00.10.06

	08.02.2020	Bewirkt ein Control-Command mehr als 2 Fehler, wird er an das Ende der Queue
				geschoben und eine Fehlermeldung wird in den Log geschrieben. Bei 10 Fehlern
				wird er aus der Queue entfernt. Auf diese Weise wird verhindert, dass ein
				 nichtausführbarer Befehl die Command-Queue blockiert.
				
				Debug-Meldungen von Info auf Debug gesetzt.
				
				Den SolvisClient noch um die Beschreibung der verschiedenen state-Werte ergänzt.  
	
	


Version 00.10.05

	07.02.2020	Bei Brenner-Laufzeit-Synchronisation war Screen-Restore invertiert.
				Bei einem moduliertem Gasbrenner gibt es keinen "C03.LaufzeitAnforderung2".
				Der fehlende Wert wird ignoriert und durch 0 ersetzt.
	
	


Version 00.10.04

	07.02.2020	Einige Info-Messages zum besseren Debuggen der Colmmand-Queue eingeführt
	            
				Bei Brenner-Laufzeit-Synchronisation war Screen-Restore invertiert.
	
	


Version 00.10.03

	06.02.2020	control.xml korrigiert. Bei der Konfiguration SolvisMax + Solarmodul war der
				Bildschirm des Solar-Anlagenstatus nicht definiert
	            
				Bei fehlenden Definition eines Bildschirmreferenz kam es zu einer Null-Pointer-
				Exception. Es erscheint nun eine sinnvolle Fehlermeldung.
	
	


Version 00.10.02

	20.01.2020  Clock-Fine-Tuning implementiert. Man kann die Solvis-Uhr doch genauer einstellen,
	            wenn man mehrfach auf den OK-Button der Zeieinstellung drückt. Jedes Stellen der
	            Uhr, bewirkt, dass die Zeit kurz "angehalten" wird. Das kann man nutzen, wenn die 
	            Solvis-Uhr genauer eingestellt werden soll, ist aber mehr eine Spielerei (Wer benötigt
	            eine genau gehende Solvis-Anlagen-Uhr, der ein Smarthome-System besitzt?).

	            
	21.02.2020	Restart des Servers nun auch vom Client möglich.
				
				Client-Server-Schnittstelle etwas geändert. Server übergibt bei Herstellung der Verbindung
				zum Client nun die möglichen Server-Befehle. Daher wurden ebenfalls Änderungen am
				Client notwendig.

	
	23.01.2020	Bug beim Setzen der Uhr behoben. Uhr wurde nicht mehr angeglichen, wenn der Server
	            in einem bestimmten Zeitintervall gestartet wurde und ein Abgleich der Uhr beim Start
	            notwendig war.

	            
	25.01.2020	Error-Detection erweitert. Der Status der Solvis-Anlage ist auch dann in dem
	            Error-Status, wenn auf dem Home-Bildschirm rechts nicht mehr die Uhrzeit mit dem Datum
	            angezeigt wird, sondern ein Button mit einem Achtung-Zeichen.

	            
	29.01.2020	Contol-Command-Optimierung deaktivierbar

	
	30.01.2020	Bug im Uhr-Abgleich behoben. Es wurde nicht beachtet, dass zum Zeitpunkt der Uhreinstellung
				(Klick auf den OK-Button) gerade der Minutenwechsel der Solvis-Uhr erfolgen kann. In diesem
				Fall war es möglich, dass die Solvis-Uhr danach um 60s nach ging. Der Einstellzeitpunkt ist
				nun zum Zeitpunkt hh:mm:05 (nach Solvis-Zeit).

	
	31.01.2020	In der Statistik des Uhrenabgleichs wurde eine Auffälligkeit erkannt:
				Die Solvis-Steuerung kann sporadisch beim Einstellen der Uhr abstürzen! Das erfolgt nach
				Langzeitbeobachtung mit der Wahrscheinlichkeit von etwa 1:200. In diesem Fall erfolgt ca. 10s
				keinerlei Reaktion von der SolvisControl. Nach Ablauf dieser Zeit scheint ein Watch-Dog der
				SolvisControl den Hänger erkannt zu haben, der dann anschließend die komplette Steuerung
				zurücksetzt. Dieses Verhalten wird letztlich von Solvis bestätigt:
				  "Wenn man die Uhrzeit verstellt, kann es passieren, dass Timer unkontrolliert überlaufen und
				   die Funktionen dann neu gestartet werden. Das ist aber kein Fehler, sondern eine Reaktion
				   auf die geänderten Parameter."
				Das hat zur Folge, dass ein laufender Brenner stoppt und der Mischer erstmal auf die Null-Position
				zurück fährt. Auch behält die Anlage nicht die Einstellung der WW-Pumpe, sie geht - wie beim 
				Einschalten - auf den Modus "Auto". Aus Sicherheitsgründen ist das Stellen der Uhr nun abhängig
				vom Brenner, wenn er läuft, erfolgt kein Einstellen. Selbst wenn das automatische Rücksetzen der
				SolvisContriol dann doch mal ausbleiben sollte (was ich nie beobachtet hatte), kann nichts
				schlimmes passieren. Auch laufendes WW unterbindet das Stellen der Uhr.
				Wer ganz auf Nummer sicher gehen will deaktiviert das automatische Stellen der Uhr im "base.xml"-File

				
	04.02.2020	Der Watch-Dog muss auch zwischen den Kommandos ausgeführt werden, welche über das GUI der
				SolvisControl gehen, andernfalls wird u.U. der Screen-Saver nicht erkannt.
				
				Kleiner Bug bei der Synchronisation der Brenner-Laufzeit behoben. Screen blieb im
				Synchronisationsfall bis zum Ende der Brenner-Laufzeit gelockt, auch wenn die
				Synchronisation längst abgeschlossen war.

				
	05.02.2020	Bei SolvisRemote-Firmware < 2.21.02A gibt es einen IOException, welche ignoriert werden muss.
				Die base.xml daher um das Attribut "fwLth2_21_02A" ergänzt, das auf true gesetzt werden muss,
				wenn die SolvisRemote mit einer älteren FW geflasht ist.




Version 00.10.01

	15.01.2020	Average-Routine geändert. Einzelne Messausreißer konnten die angezeigte Genauigkeit
	            der Sensoren stark reduzieren. Es wurde daher der Algorithmus geändert und in der Datei
	            das Attribut "measurementHysteresisFactor" eingeführt.
	            
	16.01.2020  Die Erkennung von User-Eingriffen funktionierte nicht mehr. Fixed.
	
	17.01.2020	Modus mit mehr als einem Heizkreis übverarbeitet und sowei möglich getestet.
	
	


Version 00.10.00
	1. Release